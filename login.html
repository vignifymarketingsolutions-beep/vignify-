<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-M5SJF61B15"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-M5SJF61B15');
</script>

<script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "uhvknh2uat");
</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Access - Vignify Marketing Solutions</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />

    <link rel="icon" type="image/svg+xml" href="favicon.svg1.svg" />
     <link rel="icon" type="image/png" href="favicon96.png" sizes="96x96" />
    <link rel="shortcut icon" href="favicon.ico1.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="apple png.png" />
    <link rel="manifest" href="site.webmanifest1.webmanifest" />
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }

        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .hidden-field { display: none !important; }
        
        .animate-blob { animation: blob 7s infinite; }
        .animation-delay-2000 { animation-delay: 2s; }
        @keyframes blob {
            0% { transform: translate(0px, 0px) scale(1); }
            33% { transform: translate(30px, -50px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
            100% { transform: translate(0px, 0px) scale(1); }
        }
    </style>
</head>

<body class="bg-gray-100 flex items-center justify-center min-h-screen relative overflow-hidden p-4">

    <div class="absolute top-0 left-0 w-96 h-96 bg-yellow-300 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob"></div>
    <div class="absolute bottom-0 right-0 w-96 h-96 bg-pink-300 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-2000"></div>

    <div class="relative w-full max-w-4xl bg-white/90 backdrop-blur-lg rounded-3xl shadow-2xl overflow-hidden flex flex-col md:flex-row z-10">
        
        <div class="w-full md:w-5/12 bg-gradient-to-br from-yellow-400 via-pink-500 to-purple-600 p-10 text-white flex flex-col justify-between relative overflow-hidden">
            <div class="absolute -top-10 -left-10 w-40 h-40 bg-white opacity-10 rounded-full"></div>
            <div class="absolute bottom-10 right-10 w-20 h-20 bg-white opacity-10 rounded-full"></div>

            <div class="z-10">
    <a href="index.html" class="flex items-center gap-3 mb-8">
        <img src="favicon.svg1.svg" alt="Vignify Logo" class="h-10 w-10 object-contain">
        <span class="text-2xl font-bold tracking-wide">Vignify</span>
    </a>
    <h2 class="text-3xl font-bold mb-4 leading-tight" id="welcomeTitle">Welcome Back!</h2>
    <p class="text-white/90 leading-relaxed text-sm md:text-base" id="welcomeText">
        Log in to access your SEO reports, track your ad performance, and manage your digital growth strategy.
    </p>
</div>

            <div class="z-10 mt-12 md:mt-0 pt-8 border-t border-white/20">
                <p class="italic text-xs md:text-sm opacity-80">"Success is not final, failure is not fatal: it is the courage to continue that counts."</p>
            </div>
        </div>

        <div class="w-full md:w-7/12 p-8 md:p-12 bg-white relative">
            
            <div class="text-center mb-8">
                <h3 class="text-2xl font-bold text-gray-900" id="formTitle">Sign In</h3>
                <p class="text-sm text-gray-500 mt-2" id="formSubtitle">Enter your details to access your dashboard</p>
            </div>

            <div id="messageBox" class="hidden mb-4 p-3 rounded-lg bg-red-50 text-red-600 text-sm border border-red-200 flex items-center">
                <i class="fas fa-exclamation-circle mr-2"></i> 
                <span id="messageText"></span>
            </div>

            <form id="authForm" class="space-y-5">
                
                <div id="nameFieldContainer" class="hidden-field">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-user text-gray-400"></i>
                        </div>
                        <input type="text" id="nameInput" class="w-full pl-10 pr-4 py-3 rounded-xl border border-gray-200 bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-pink-400 focus:border-transparent transition" placeholder="John Doe">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Email Address</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-envelope text-gray-400"></i>
                        </div>
                        <input type="email" id="emailInput" class="w-full pl-10 pr-4 py-3 rounded-xl border border-gray-200 bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-pink-400 focus:border-transparent transition" placeholder="name@company.com">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-lock text-gray-400"></i>
                        </div>
                        <input type="password" id="passwordInput" class="w-full pl-10 pr-10 py-3 rounded-xl border border-gray-200 bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-pink-400 focus:border-transparent transition" placeholder="••••••••">
                        <button type="button" id="togglePasswordBtn" class="absolute inset-y-0 right-0 pr-3 flex items-center cursor-pointer focus:outline-none">
                            <i class="fas fa-eye text-gray-400 hover:text-pink-500 transition" id="eyeIcon"></i>
                        </button>
                    </div>
                </div>

                <div id="confirmPasswordFieldContainer" class="hidden-field">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Confirm Password</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-lock text-gray-400"></i>
                        </div>
                        <input type="password" id="confirmPasswordInput" class="w-full pl-10 pr-4 py-3 rounded-xl border border-gray-200 bg-gray-50 focus:bg-white focus:outline-none focus:ring-2 focus:ring-pink-400 focus:border-transparent transition" placeholder="••••••••">
                    </div>
                </div>

                <div class="flex items-center justify-between text-sm" id="forgotPasswordContainer">
                    <label class="flex items-center text-gray-600 cursor-pointer">
                        <input type="checkbox" class="form-checkbox h-4 w-4 text-pink-500 rounded border-gray-300 focus:ring-pink-400">
                        <span class="ml-2">Remember me</span>
                    </label>
                    <a href="#" id="forgotPasswordLink" class="text-pink-600 hover:text-pink-700 font-semibold transition">Forgot Password?</a>
                </div>

                <button type="submit" id="submitBtn" class="w-full bg-gradient-to-r from-orange-400 to-pink-600 text-white font-bold py-3 rounded-xl shadow-lg hover:shadow-xl hover:from-orange-500 hover:to-pink-700 transform hover:-translate-y-0.5 transition-all duration-200 flex justify-center items-center gap-2 relative overflow-hidden">
                    <span id="btnText">Log In</span>
                    <i class="fas fa-arrow-right" id="btnIcon"></i>
                    <i class="fas fa-circle-notch fa-spin hidden" id="btnSpinner"></i>
                </button>
            </form>

            <div class="mt-8 text-center text-sm text-gray-600" id="accountToggleWrapper">
                <span id="toggleText">Don't have an account?</span> 
                <button id="toggleModeBtn" class="text-pink-600 font-bold hover:underline ml-1 focus:outline-none transition">Create Account</button>
            </div>
        </div>
    </div>


  <script type="module">
  // 1. Import Firebase Functions
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

  // --- CONFIGURATION ---
  const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxo05weXb4EUu-Ud9u6DxK3VksjbK-WG2Y6Px1R-RSZfIHN7X9HGI9J_qUFXOWqiR_D/exec"; 

  const firebaseConfig = {
    apiKey: "AIzaSyBuM5nE3YxVSqrLtA5dGIgut8Ka9iTUKJo",
    authDomain: "vignify-19f75.firebaseapp.com",
    projectId: "vignify-19f75",
    storageBucket: "vignify-19f75.firebasestorage.app",
    messagingSenderId: "443199728178",
    appId: "1:443199728178:web:48e11464eddf8f35376a2b",
    measurementId: "G-6VX07FW44V"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  let isLoginMode = true;

  // DOM Elements
  const authForm = document.getElementById('authForm');
  const emailInput = document.getElementById('emailInput');
  const passwordInput = document.getElementById('passwordInput');
  const confirmPasswordInput = document.getElementById('confirmPasswordInput');
  const nameInput = document.getElementById('nameInput');
  const nameFieldContainer = document.getElementById('nameFieldContainer');
  const confirmPasswordFieldContainer = document.getElementById('confirmPasswordFieldContainer');
  const forgotPasswordContainer = document.getElementById('forgotPasswordContainer');
  const forgotPasswordLink = document.getElementById('forgotPasswordLink');
  
  const formTitle = document.getElementById('formTitle');
  const formSubtitle = document.getElementById('formSubtitle');
  const submitBtn = document.getElementById('submitBtn');
  const btnText = document.getElementById('btnText');
  const btnIcon = document.getElementById('btnIcon');
  const btnSpinner = document.getElementById('btnSpinner');
  const toggleText = document.getElementById('toggleText');
  const toggleModeBtn = document.getElementById('toggleModeBtn');
  const togglePasswordBtn = document.getElementById('togglePasswordBtn');
  const eyeIcon = document.getElementById('eyeIcon');
  const messageBox = document.getElementById('messageBox');
  const messageText = document.getElementById('messageText');

  // --- EVENT LISTENERS ---

  togglePasswordBtn.addEventListener('click', () => {
      const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
      passwordInput.setAttribute('type', type);
      eyeIcon.classList.toggle('fa-eye');
      eyeIcon.classList.toggle('fa-eye-slash');
  });

  toggleModeBtn.addEventListener('click', () => {
      isLoginMode = !isLoginMode;
      updateUIForMode();
      clearErrors();
      authForm.reset();
  });

  forgotPasswordLink.addEventListener('click', (e) => {
      e.preventDefault();
      const email = emailInput.value;
      if (!email) {
          showError("Please enter your email address in the box above to reset your password.");
          emailInput.focus();
          return;
      }
      setLoadingState(true); 
      btnText.textContent = "Sending Email..."; 
      
      sendPasswordResetEmail(auth, email)
          .then(() => {
              setLoadingState(false);
              btnText.textContent = "Log In"; 
              messageBox.classList.remove('hidden', 'bg-red-50', 'text-red-600', 'border-red-200');
              messageBox.classList.add('bg-green-50', 'text-green-600', 'border-green-200');
              messageBox.innerHTML = `<i class="fas fa-check-circle mr-2"></i> Password reset email sent! Check your inbox.`;
          })
          .catch((error) => {
              setLoadingState(false);
              btnText.textContent = "Log In"; 
              handleError(error);
          });
  });

  authForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    clearErrors();

    const email = emailInput.value;
    const password = passwordInput.value;
    const name = nameInput.value; 

    if (password.length < 6) {
        showError("Password must be at least 6 characters long.");
        return;
    }

    if (!isLoginMode) {
        const confirmPassword = confirmPasswordInput.value;
        if (password !== confirmPassword) {
            showError("Passwords do not match.");
            return;
        }
    }

    setLoadingState(true);

    try {
        let userCredential;
        let actionType = "";

        if (isLoginMode) {
            // Log In
            userCredential = await signInWithEmailAndPassword(auth, email, password);
            actionType = "Login";
        } else {
            // Sign Up
            userCredential = await createUserWithEmailAndPassword(auth, email, password);
            actionType = "Signup";
        }

        // Send to Sheet
        await logToGoogleSheet(email, name, actionType);

        // Handle Success (Redirect & Save Name)
        handleSuccess(userCredential.user);

    } catch (error) {
        handleError(error);
        setLoadingState(false);
    }
  });

  // --- HELPER FUNCTIONS ---

  async function logToGoogleSheet(email, name, action) {
    if(GOOGLE_SCRIPT_URL.includes("PASTE_YOUR")) return;
    const data = { email: email, name: name || "N/A", action: action };
    try {
        await fetch(GOOGLE_SCRIPT_URL, {
            method: "POST", mode: "no-cors",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        });
    } catch (err) { console.error("Sheet error", err); }
  }

  function handleSuccess(user) {
      console.log("Authentication successful:", user);

      // --- NEW: SAVE USERNAME FOR HOME PAGE ---
      // This is the missing link!
      let displayName;

      if (!isLoginMode && nameInput.value) {
          // If Signing Up, use the name they typed
          displayName = nameInput.value;
      } else {
          // If Logging In, use name from Firebase or Email prefix
          displayName = user.displayName || user.email.split('@')[0];
          // Example: "john@gmail.com" becomes "john"
          // Capitalize first letter
          displayName = displayName.charAt(0).toUpperCase() + displayName.slice(1);
      }

      // Save to Browser Memory
      localStorage.setItem('vignify_username', displayName);
      // ----------------------------------------

      messageBox.classList.remove('hidden', 'bg-red-50', 'text-red-600', 'border-red-200');
      messageBox.classList.add('bg-green-50', 'text-green-600', 'border-green-200');
      messageBox.innerHTML = `<i class="fas fa-check-circle mr-2"></i> Success! Redirecting...`;
      
      setTimeout(() => {
          window.location.href = "index.html"; 
      }, 1000);
  }

  function handleError(error) {
      console.error("Auth Error:", error.code, error.message);
      let friendlyMessage = "An error occurred. Please try again.";
      switch (error.code) {
          case 'auth/invalid-credential':
          case 'auth/user-not-found':
          case 'auth/wrong-password': friendlyMessage = "Incorrect email or password."; break;
          case 'auth/email-already-in-use': friendlyMessage = "Email already registered. Please log in."; break;
          case 'auth/too-many-requests': friendlyMessage = "Too many attempts. Please try again later."; break;
          case 'auth/network-request-failed': friendlyMessage = "Network error. Check your connection."; break;
      }
      showError(friendlyMessage);
  }

  function updateUIForMode() {
      if (isLoginMode) {
          nameFieldContainer.classList.add('hidden-field');
          confirmPasswordFieldContainer.classList.add('hidden-field');
          forgotPasswordContainer.classList.remove('hidden-field');
          formTitle.textContent = "Sign In";
          formSubtitle.textContent = "Enter your details to access your dashboard";
          btnText.textContent = "Log In";
          toggleText.textContent = "Don't have an account?";
          toggleModeBtn.textContent = "Create Account";
      } else {
          nameFieldContainer.classList.remove('hidden-field');
          nameFieldContainer.classList.add('fade-in');
          confirmPasswordFieldContainer.classList.remove('hidden-field');
          confirmPasswordFieldContainer.classList.add('fade-in');
          forgotPasswordContainer.classList.add('hidden-field');
          formTitle.textContent = "Create Account";
          formSubtitle.textContent = "Get started with Vignify today";
          btnText.textContent = "Sign Up";
          toggleText.textContent = "Already have an account?";
          toggleModeBtn.textContent = "Log In";
      }
  }

  function setLoadingState(isLoading) {
      if (isLoading) {
          submitBtn.disabled = true;
          btnText.textContent = isLoginMode ? "Logging in..." : "Creating...";
          btnIcon.classList.add('hidden');
          btnSpinner.classList.remove('hidden');
      } else {
          submitBtn.disabled = false;
          btnText.textContent = isLoginMode ? "Log In" : "Sign Up";
          btnIcon.classList.remove('hidden');
          btnSpinner.classList.add('hidden');
      }
  }

  function showError(msg) {
    messageBox.classList.remove('hidden');
    messageBox.classList.add('bg-red-50', 'text-red-600', 'border-red-200');
    messageBox.classList.remove('bg-green-50', 'text-green-600', 'border-green-200');
    messageText.textContent = msg;
  }

  function clearErrors() {
      messageBox.classList.add('hidden');
      messageText.textContent = "";
  }

  updateUIForMode();
</script>
</script>
</body>
</html>